(this["webpackJsonpmovies-app"]=this["webpackJsonpmovies-app"]||[]).push([[0],{11:function(e,t,a){e.exports=a(20)},16:function(e,t,a){},17:function(e,t,a){},19:function(e,t,a){},20:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),s=a(5),i=a.n(s);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(16),a(17);var o=a(1),c=a.n(o),u=a(3),l=a(2),p=a(6),m=a(7),d=a(8),v=a(9),f=a(10),b="https://api.themoviedb.org",g="21629b2bbf4bb4857806d309dcfd1837";function h(){return k.apply(this,arguments)}function k(){return(k=Object(l.a)(c.a.mark((function e(){var t,a,r,n,s,i,o=arguments;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=o.length>0&&void 0!==o[0]?o[0]:0,a=o.length>1&&void 0!==o[1]?o[1]:12,e.prev=2,r=[],n=t;n<a;n++)r.push(fetch("".concat(b,"/3/movie/").concat(n,"?api_key=").concat(g)));return e.next=7,Promise.all(r);case 7:return s=e.sent,i=s.filter((function(e){return 200===e.status})),e.abrupt("return",i.length?i:null);case 12:return e.prev=12,e.t0=e.catch(2),console.log(e.t0),e.abrupt("return",null);case 16:case"end":return e.stop()}}),e,null,[[2,12]])})))).apply(this,arguments)}function N(e){return e.reduce((function(e,t){return e[t.id]=t,e}),{})}function w(e){return e.map((function(e){return Object(f.a)({},e,{banner:e.poster_path?"".concat("https://image.tmdb.org","/t/p/w300").concat(e.poster_path):null})}))}function x(){return y.apply(this,arguments)}function y(){return(y=Object(l.a)(c.a.mark((function e(){var t,a,r,n,s,i,o,l,p,m,d,v=arguments;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=v.length>0&&void 0!==v[0]?v[0]:12,a=v.length>1&&void 0!==v[1]?v[1]:0,r=[],n=a,s=0;case 5:if(!(r.length<t)){e.next=25;break}return i=n,o=n+(t-r.length),e.next=10,h(i,o);case 10:if(l=e.sent){e.next=17;break}if(n++,40!==++s){e.next=16;break}return e.abrupt("return",{error:!0,movies:{},firstMovId:0,lastMovId:0});case 16:return e.abrupt("continue",5);case 17:return s=0,e.next=20,Promise.all(l.map((function(e){return e.json()})));case 20:p=e.sent,r=[].concat(Object(u.a)(r),Object(u.a)(p)),n=p[p.length-1].id+1,e.next=5;break;case 25:return m=w(r),d=N(m),e.abrupt("return",{error:!1,movies:d,firstMovId:r[0].id,lastMovId:r[r.length-1].id});case 28:case"end":return e.stop()}}),e)})))).apply(this,arguments)}a(19);var E=function(e){Object(v.a)(a,e);var t=Object(d.a)(a);function a(){var e;return Object(p.a)(this,a),(e=t.call(this)).fetchMovies=Object(l.a)(c.a.mark((function t(){var a,r,n,s,i,o,l,p;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.setState((function(){return{isLoading:!0}}));case 2:return a=e.state,r=a.moviesOnPage,n=a.lastMovieId,t.next=5,x(r,n+1);case 5:if(s=t.sent,i=s.error,o=s.movies,l=s.firstMovId,p=s.lastMovId,!i){t.next=14;break}return t.next=13,e.setState((function(){return{error:!0}}));case 13:return t.abrupt("return");case 14:return t.next=16,e.setState((function(){return{movies:o,error:i,firstMovieId:l,lastMovieId:p,pageHistory:Object(u.a)(new Set([].concat(Object(u.a)(e.state.pageHistory),[l]))),isLoading:!1}}));case 16:case"end":return t.stop()}}),t)}))),e.paginationHandler=function(){var t=Object(l.a)(c.a.mark((function t(a){var r,n;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=a.target.dataset.page,t.t0=r,t.next="first"===t.t0?4:"previous"===t.t0?7:"next"===t.t0?12:15;break;case 4:return t.next=6,e.setState((function(){return{pageNumber:1,lastMovieId:0}}));case 6:return t.abrupt("break",15);case 7:return n=e.state.pageHistory[e.state.pageNumber-2],console.log("newLastId",n),t.next=11,e.setState((function(){return{pageNumber:1!==e.state.pageNumber?e.state.pageNumber-1:e.state.pageNumber,lastMovieId:e.state.pageHistory[e.state.pageNumber-2]-1}}));case 11:return t.abrupt("break",15);case 12:return t.next=14,e.setState((function(){return{pageNumber:e.state.pageNumber+1}}));case 14:return t.abrupt("break",15);case 15:e.fetchMovies();case 16:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.state={error:!1,movies:null,moviesOnPage:12,pageNumber:1,firstMovieId:0,lastMovieId:0,pageHistory:[],isLoading:!1},e}return Object(m.a)(a,[{key:"componentDidMount",value:function(){this.fetchMovies()}},{key:"render",value:function(){var e=!this.state.movies||this.state.error?n.a.createElement("div",null,"Error for fetching movies... Connect with administrator, please."):Object.values(this.state.movies).map((function(e){return n.a.createElement("div",{className:"movie-card",key:e.id,style:{backgroundImage:"url(".concat(e.banner?e.banner:"./img/blank-img.jpg",")")}},"id: ",e.id,", Title: ",e.original_title)}));return n.a.createElement("div",{className:"app-wrapper"},n.a.createElement("header",null,n.a.createElement("div",{className:"header-wrapper"},n.a.createElement("h1",null,"Movies by TMDB"))),n.a.createElement("main",null,n.a.createElement("div",{className:"main-wrapper"},e)),n.a.createElement("footer",null,n.a.createElement("div",{className:"footer-wrapper"},n.a.createElement("button",{"data-page":"first",onClick:this.paginationHandler,disabled:!(1!==this.state.pageNumber&&!this.state.error&&!this.state.isLoading),className:"primary"},"Page 1"),n.a.createElement("button",{"data-page":"previous",onClick:this.paginationHandler,disabled:!(1!==this.state.pageNumber&&!this.state.error&&!this.state.isLoading),className:"primary"},n.a.createElement("i",{className:"fa fa-chevron-left"}),"Prev"),n.a.createElement("span",{"data-page":"current",className:"current-page"},"Current Page:",n.a.createElement("span",{className:"current-page__number"}," ",this.state.pageNumber)),n.a.createElement("button",{"data-page":"next",onClick:this.paginationHandler,disabled:!(!this.state.error&&!this.state.isLoading),className:"primary"},"Next",n.a.createElement("i",{className:"fa fa-chevron-right"})))))}}]),a}(r.Component);i.a.render(n.a.createElement(E,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[11,1,2]]]);
//# sourceMappingURL=main.1c97a5d4.chunk.js.map